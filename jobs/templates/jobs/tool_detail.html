{% extends "jobs/base.html" %}

{% block title %}
    {% if custom_title %}{{ custom_title }} | MarTechJobs{% else %}Top {{ tool.name }} Jobs & Career Guide {% now "Y" %} ‚Äî MarTechJobs{% endif %}
{% endblock %}

{% block meta_description %}
    {% if custom_desc %}
        {{ custom_desc }}
    {% else %}
        Browse the best Marketing Operations and MarTech roles requiring {{ tool.name }} expertise. We curate {{ tool.name }} jobs from top companies.
    {% endif %}
{% endblock %}

{% block content %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "name": "Home",
    "item": "{{ request.scheme }}://{{ request.get_host }}/"
  },{
    "@type": "ListItem",
    "position": 2,
    "name": "Tech Stacks",
    "item": "{{ request.scheme }}://{{ request.get_host }}/"
  },{
    "@type": "ListItem",
    "position": 3,
    "name": "{{ tool.name }} Jobs",
    "item": "{{ request.build_absolute_uri }}"
  }]
}
</script>

<div class="relative bg-white border-b border-slate-100 overflow-hidden">
    <div class="absolute inset-0 bg-grid-pattern pointer-events-none"></div>
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        
        <div class="flex flex-col md:flex-row items-center md:items-start gap-8">
            {% if tool.logo_url %}
            <div class="flex-shrink-0 w-24 h-24 bg-white border border-slate-200 rounded-xl p-4 flex items-center justify-center shadow-sm">
                <img src="{{ tool.logo_url }}" alt="{{ tool.name }} Logo" class="max-w-full max-h-full object-contain">
            </div>
            {% endif %}

            <div class="text-center md:text-left">
                <h1 class="text-4xl md:text-6xl font-serif font-medium text-slate-900 mb-6">
                    {% if custom_header %}
                        {{ custom_header|safe }}
                    {% else %}
                        <span class="text-martech-green">{{ tool.name }}</span> Jobs
                    {% endif %}
                </h1>
                
                {% if tool.description %}
                    <div class="prose prose-slate max-w-2xl text-slate-500 font-light leading-relaxed mb-6">
                        {{ tool.description|safe }}
                    </div>
                {% else %}
                    <p class="text-lg text-slate-500 max-w-2xl mb-8 font-light">
                        {% if custom_desc %}
                            {{ custom_desc }}
                        {% else %}
                            Browse the best Marketing Operations and MarTech roles requiring <strong>{{ tool.name }}</strong> expertise. 
                            We curate {{ tool.name }} jobs from top companies to help you find your next career move.
                        {% endif %}
                    </p>
                {% endif %}

                <a href="/" class="inline-flex items-center text-sm font-bold text-slate-400 hover:text-martech-green transition">
                    &larr; View all MarTech Jobs
                </a>
            </div>
        </div>

    </div>
</div>

<div class="bg-slate-50 py-16">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 space-y-4">
        
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-slate-900">Active Roles</h2>
            <span class="text-xs font-bold bg-white border border-slate-200 px-2 py-1 rounded text-slate-500">{{ jobs.paginator.count }} Found</span>
        </div>

        {% for job in jobs %}
            <div class="bg-white border border-black rounded-sm p-4 hover:shadow-md transition-all duration-200 group relative">
                
                <div class="flex flex-col md:flex-row gap-4 items-start">
                    
                    <div class="flex-shrink-0">
                        {% if job.company_logo %}
                            <div class="w-14 h-14 border border-slate-100 rounded-md p-2 flex items-center justify-center bg-white">
                                <img src="{{ job.company_logo }}" alt="{{ job.company }}" class="max-w-full max-h-full object-contain">
                            </div>
                        {% else %}
                            <div class="w-14 h-14 rounded-md bg-slate-50 border border-slate-200 flex items-center justify-center text-xl font-serif font-bold text-slate-400">
                                {{ job.company|slice:":1" }}
                            </div>
                        {% endif %}
                    </div>

                    <div class="flex-grow">
                        <h3 class="text-xl font-serif font-bold text-slate-900 leading-tight mb-1 flex items-center gap-2">
                            <a href="{% url 'job_detail' job.id job.slug %}" class="hover:underline decoration-2 decoration-slate-300 underline-offset-4">
                                {{ job.title }}
                            </a>
                            {% if job.is_featured %}
                                <span class="bg-[#1f432d] text-white text-[9px] font-bold px-1.5 py-0.5 rounded-full uppercase tracking-wider">New</span>
                            {% endif %}
                        </h3>
                        <p class="text-sm text-slate-500 font-medium mb-2">{{ job.company }}</p>
                        
                        <div class="flex flex-wrap gap-2">
                            <div class="inline-flex items-center gap-1.5 px-2 py-0.5 rounded bg-slate-50 border border-gray-300 text-[10px] font-mono text-slate-800 uppercase tracking-wide">
                                <svg class="w-3 h-3 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                {{ job.location|default:"Remote" }}
                            </div>

                            {% if job.salary_range %}
                            <div class="inline-flex items-center gap-1.5 px-2 py-0.5 rounded bg-slate-50 border border-gray-300 text-[10px] font-mono text-slate-800 uppercase tracking-wide">
                                <svg class="w-3 h-3 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                                {{ job.salary_range }}
                            </div>
                            {% endif %}

                            <div class="inline-flex items-center gap-1.5 px-2 py-0.5 rounded bg-slate-50 border border-gray-300 text-[10px] font-mono text-slate-800 uppercase tracking-wide">
                                <svg class="w-3 h-3 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                {{ job.get_role_type_display|upper }}
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col justify-between items-end gap-3 min-w-[140px] self-stretch py-1">
                        <div class="flex gap-1.5">
                            {% for t in job.tools.all|slice:":2" %}
                            <span class="{{ t.color_class }} px-2 py-0.5 rounded text-[10px] font-bold border opacity-90 shadow-sm">
                                {{ t.name }}
                            </span>
                            {% endfor %}
                        </div>

                        <div class="w-full border-t border-gray-200 my-1"></div>

                        <a href="{% url 'job_detail' job.id job.slug %}" class="bg-[#1f432d] hover:bg-green-900 text-white font-bold py-2 px-5 rounded shadow-sm text-xs transition-colors whitespace-nowrap">
                            Apply Now
                        </a>
                    </div>

                </div>
            </div>
        {% empty %}
            <div class="text-center py-20 bg-white border border-dashed border-slate-300 rounded-xl">
                <div class="mx-auto w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center mb-3 text-xl">ü§∑‚Äç‚ôÇÔ∏è</div>
                <h3 class="text-base font-bold text-slate-900 font-serif">No active {{ tool.name }} jobs.</h3>
                <p class="text-slate-500 mt-1 mb-4 text-sm">Our bots are hunting. Check back tomorrow!</p>
                <a href="/" class="text-martech-green font-bold hover:underline text-xs">Browse All Jobs</a>
            </div>
        {% endfor %}

        {% if jobs.paginator.num_pages > 1 %}
        <div class="mt-10 flex justify-center">
            <div class="inline-flex rounded-md shadow-sm">
                {% if jobs.has_previous %}
                    <a href="?page={{ jobs.previous_page_number }}" class="py-2 px-4 bg-white border border-gray-300 rounded-l-lg hover:bg-gray-50 font-medium text-xs text-gray-700">Previous</a>
                {% endif %}
                
                <span class="py-2 px-4 bg-gray-50 border-t border-b border-gray-300 font-medium text-xs text-gray-700">
                    Page {{ jobs.number }} of {{ jobs.paginator.num_pages }}
                </span>

                {% if jobs.has_next %}
                    <a href="?page={{ jobs.next_page_number }}" class="py-2 px-4 bg-white border border-gray-300 rounded-r-lg hover:bg-gray-50 font-medium text-xs text-gray-700">Next</a>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% extends "jobs/base.html" %}
{% load static %}

{% block title %}Post a Job â€” MarTechJobs{% endblock %}

{% block content %}
<div class="bg-background-alt min-h-screen pb-20">
    
    <div class="bg-white border-b border-border-light">
        <div class="max-w-3xl mx-auto px-4 lg:px-8 py-12 text-center">
            <h1 class="text-4xl md:text-5xl font-serif font-bold text-text-main mb-4 tracking-tight">
                Find your next MarTech expert
            </h1>
            <p class="text-lg text-text-muted font-light max-w-2xl mx-auto">
                Reach 15,000+ specialized professionals in Marketing Ops, Analytics, and Engineering.
            </p>
        </div>
    </div>

    <div class="max-w-3xl mx-auto px-4 lg:px-8 -mt-8">
        <div class="bg-white border border-border-light rounded-sm shadow-sm p-8 md:p-10">
            
            <form method="post" enctype="multipart/form-data" class="space-y-10">
                {% csrf_token %}

                <input type="hidden" name="plan" value="free">

                <section>
                    <div class="flex items-center gap-4 mb-8 pb-4 border-b border-border-light">
                        <div class="size-8 rounded-full bg-text-main text-white flex items-center justify-center font-bold font-serif">1</div>
                        <h3 class="text-xl font-serif font-bold text-text-main">Role Details</h3>
                    </div>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-bold text-text-main mb-2 font-serif">Job Title <span class="text-red-500">*</span></label>
                            {{ form.title }}
                            <p class="text-xs text-text-muted mt-1.5 font-mono">e.g. Senior Marketing Ops Manager</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold text-text-main mb-2 font-serif">Company Name <span class="text-red-500">*</span></label>
                                {{ form.company }}
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-text-main mb-2 font-serif">Company Logo URL</label>
                                {{ form.company_logo }}
                                <p class="text-xs text-text-muted mt-1.5 font-mono">Link to a square logo image (PNG/JPG)</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold text-text-main mb-2 font-serif">Location <span class="text-red-500">*</span></label>
                                {{ form.location }}
                                <p class="text-xs text-text-muted mt-1.5 font-mono">e.g. New York, NY or Remote</p>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-text-main mb-2 font-serif">Work Arrangement</label>
                                {{ form.work_arrangement }}
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold text-text-main mb-2 font-serif">Role Type</label>
                                {{ form.role_type }}
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-text-main mb-2 font-serif">Salary Range</label>
                                {{ form.salary_range }}
                                <p class="text-xs text-text-muted mt-1.5 font-mono">e.g. $120k - $150k</p>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-text-main mb-2 font-serif">Tech Stack <span class="text-red-500">*</span></label>
                            {{ form.new_tools }}
                            <div class="flex flex-wrap gap-2 mt-3" id="tech-stack-preview">
                                </div>
                            <p class="text-xs text-text-muted mt-1.5 font-mono">Comma separated. e.g. HubSpot, Salesforce, Marketo, SQL</p>
                        </div>

                        <div>
                            <label class="block text-sm font-bold text-text-main mb-2 font-serif">Application Link <span class="text-red-500">*</span></label>
                            {{ form.application_url }}
                            <p class="text-xs text-text-muted mt-1.5 font-mono">The URL where candidates should apply.</p>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="flex items-center gap-4 mb-8 pb-4 border-b border-border-light">
                        <div class="size-8 rounded-full bg-text-main text-white flex items-center justify-center font-bold font-serif">2</div>
                        <h3 class="text-xl font-serif font-bold text-text-main">Job Description</h3>
                    </div>

                    <div>
                        <div class="prose max-w-none">
                            {{ form.description }}
                        </div>
                        <p class="text-xs text-text-muted mt-2 font-mono">Markdown is supported for formatting.</p>
                    </div>
                </section>

                <div class="pt-6 border-t border-border-light">
                    <button type="submit" class="w-full bg-primary hover:bg-primary-hover text-white font-bold text-lg py-4 rounded-sm shadow-md transition-all transform hover:-translate-y-0.5">
                        Post Job for Free
                    </button>
                    <p class="text-center text-xs text-text-muted mt-4 font-mono">
                        By posting, you agree to our Terms of Service and Privacy Policy.
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 1. Auto-Style Django Form Fields to match the new design
        const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="url"], select, textarea');
        inputs.forEach(input => {
            // Apply Tailwind classes
            let classes = [
                'w-full', 'px-4', 'py-3', 'rounded-sm', 
                'border', 'border-border-light', 'bg-white',
                'text-text-main', 'text-sm', 'font-medium',
                'focus:border-primary', 'focus:ring-1', 'focus:ring-primary', 'focus:outline-none',
                'transition-all', 'placeholder-gray-400'
            ];
            input.classList.add(...classes);
            
            // Specific styling for textarea
            if(input.tagName === 'TEXTAREA') {
                input.classList.add('h-64', 'font-mono', 'text-sm');
            }
        });

        // 2. Tech Stack Tag Previewer (UX enhancement)
        const toolsInput = document.querySelector('input[name="new_tools"]');
        const previewContainer = document.getElementById('tech-stack-preview');
        
        if (toolsInput && previewContainer) {
            toolsInput.addEventListener('input', function(e) {
                const tools = e.target.value.split(',').map(t => t.trim()).filter(t => t);
                
                if (tools.length > 0) {
                    previewContainer.innerHTML = tools.map(tool => 
                        `<span class="inline-flex items-center px-2 py-1 rounded-sm bg-background-alt border border-border-light text-xs font-mono text-text-muted">${tool}</span>`
                    ).join('');
                } else {
                    previewContainer.innerHTML = '';
                }
            });
        }
    });
</script>
{% endblock %}
